@page
@model Viaproxima.Web.Pages.CharacterSheetModel
@{
    ViewData["Title"] = "Viaproxima – Character Sheet";
}

<div class="page">
    <div class="sheet">
        <!-- Header -->
        <header class="sheet-header">
            <div>
                <div class="label">Namn</div>
                <input id="nameInput" class="header-input" type="text" value="" />
            </div>
            <div>
                <div class="label">Ras</div>
                <input id="raceInput" class="header-input" type="text" value="" />
            </div>
            <div>
                <div class="label">Erfarenhetspoäng</div>
                <input id="xpInput" class="header-input" type="number" min="0" value="" />
            </div>

            <div class="header-actions">
                <button id="saveBtn" type="button" class="btn-small">Save</button>
                <span id="saveStatus" class="save-status"></span>
            </div>
        </header>

     
        <main class="sheet-main">
            <!-- Left column – stats -->
            <section class="sheet-column">
                <h2>Grundegenskaper</h2>

                <div class="stats-table">
                    <!-- Styrka group -->
                    <div class="stat-group">
                        <div class="stat-main-row">
                            <span class="stat-main-label">Styrka</span>
                            <input id="strengthInput" type="number" min="0" max="20" step="1" value=""
                                class="stat-input stat-input--main" />
                        </div>

                        <div class="stat-sub-row">
                            <span>Genomslag</span>
                            <input type="number" min="0" max="20" step="1" value="" class="stat-input" />
                        </div>
                        <div class="stat-sub-row">
                            <span>Bärförmåga</span>
                            <input id="barformagaInput" type="number" min="0" max="20" step="1" value=""
                                class="stat-input" />
                        </div>
                        <div class="stat-sub-row">
                            <span>Förflytta</span>
                            <input type="number" min="0" max="20" step="1" value="" class="stat-input" />
                        </div>
                        <div class="stat-sub-row">
                            <span>Brottas</span>
                            <input type="number" min="0" max="20" step="1" value="" class="stat-input" />
                        </div>
                    </div>

                    <!-- Skicklighet group -->
                    <div class="stat-group">
                        <div class="stat-main-row">
                            <span class="stat-main-label">Skicklighet</span>
                            <input type="number" min="0" max="20" step="1" value=""
                                class="stat-input stat-input--main" />
                        </div>
                        <div class="stat-sub-row"><span>Skytte</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Fingerfärdighet</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Träffsäkerhet</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Akrobatik</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                    </div>

                    <!-- Tålighet group -->
                    <div class="stat-group">
                        <div class="stat-main-row">
                            <span class="stat-main-label">Tålighet</span>
                            <input type="number" min="0" max="20" step="1" value=""
                                class="stat-input stat-input--main" />
                        </div>
                        <div class="stat-sub-row"><span>Mental</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Fysisk</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Blockera</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Uthållighet</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                    </div>

                    <!-- Intelligens group -->
                    <div class="stat-group">
                        <div class="stat-main-row">
                            <span class="stat-main-label">Intelligens</span>
                            <input type="number" min="0" max="20" step="1" value=""
                                class="stat-input stat-input--main" />
                        </div>
                        <div class="stat-sub-row"><span>Allmänbildning</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Logiskt tänkande</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Öga för detaljer</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Uppfinningsrikedom</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                    </div>

                    <!-- Klokhet group -->
                    <div class="stat-group">
                        <div class="stat-main-row">
                            <span class="stat-main-label">Klokhet</span>
                            <input type="number" min="0" max="20" step="1" value=""
                                class="stat-input stat-input--main" />
                        </div>
                        <div class="stat-sub-row"><span>Snabbtänkthet</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Känna av fara</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Se igenom lögner</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Magisk känsla</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                    </div>

                    <!-- Utstrålning group -->
                    <div class="stat-group">
                        <div class="stat-main-row">
                            <span class="stat-main-label">Utstrålning</span>
                            <input type="number" min="0" max="20" step="1" value=""
                                class="stat-input stat-input--main" />
                        </div>
                        <div class="stat-sub-row"><span>Ljuga</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Övertala</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Intryck</span><input type="number" min="0" max="20" step="1"
                                value="" class="stat-input" /></div>
                        <div class="stat-sub-row"><span>Väcka känslor</span><input type="number" min="0" max="20"
                                step="1" value="" class="stat-input" /></div>
                    </div>
                </div>
            </section>

            <!-- Center column – portrait -->
            <section class="sheet-column sheet-column--center">
                <h2>Porträtt &amp; Anteckningar</h2>
                <div class="portrait-placeholder">Porträtt här</div>
                <p class="hint">Senare: länk kopplad till en bild i <code>wwwroot/portraits/</code>.</p>
            </section>

            <!-- Right column – skills -->
            <section class="sheet-column">
                <h2>Färdigheter</h2>
                <ul>
                    <li>Kristallsejdare (widget senare)</li>
                    <li>Shaman (widget senare)</li>
                    <li>Övriga generiska skills</li>
                </ul>
            </section>
        </main>

        <!-- Inventory section -->
        <section class="sheet-inventory">
            <div class="inventory-header">
                <h2 style="margin:0;">Inventarie</h2>

                <div class="inventory-header-right">
                    <div>
                        <span class="inventory-barkraft-label">Bärkraft</span>
                        <strong id="barkraftValue">0</strong>
                    </div>

                    <button id="addItemBtn" class="btn-small" type="button">+ Add item</button>
                </div>
            </div>

            <div class="inventory-wrap">
                <div id="inventorySlots" class="inventory-grid inventory-slots"></div>
                <div id="inventoryItems" class="inventory-grid inventory-items"></div>
            </div>
        </section>


        <!-- Add/Edit Item dialog -->
        <dialog id="itemDialog" class="item-dialog">
            <form method="dialog" class="item-form" id="itemForm">
                <h3 style="margin:0 0 0.75rem;">Add/Edit item</h3>

                <!-- Hidden: used when editing -->
                <input type="hidden" id="itemIdInput" value="" />

                <div class="item-form-grid">

                    <!-- ITEM NAME -->
                    <label class="item-field item-field--wide">
                        <span>Namn</span>
                        <input id="itemNameInput" type="text" maxlength="60" placeholder="T.ex. 'Benkniv'..." />
                    </label>

                    <label class="item-field">
                        <span>Föremålstyp</span>
                        <select id="primarySelect">
                            <option value="">– Välj –</option>
                            <!-- populated by JS -->
                        </select>
                    </label>


                    
                    <label class="item-field">
                        <span>Subtyp</span>
                        <select id="secondarySelect">
                            <option value="">– Välj –</option>
                            <!-- populated by JS -->
                        </select>
                    </label>

                    <label class="item-field">
                        <span>Vikt / Storlek</span>
                        <select id="sizeSelect">
                            <option value="1x1">1x1</option>
                            <option value="1x2">1x2</option>
                            <option value="2x1">2x1</option>
                            <option value="2x2">2x2</option>
                            <option value="3x2">3x2</option>
                        </select>
                    </label>

                    <label class="item-field item-field--checkbox">
                        <span>Magisk</span>
                        <input id="magicCheck" type="checkbox" />
                    </label>

                    <div id="durabilityWrap" class="item-field">
                        <span>Hållbarhet</span>
                        <input id="durabilityInput" type="number" min="0" step="1" value="" />
                        <small class="hint">Visas bara när JS väljer att aktivera den.</small>
                    </div>

                    <!-- Icon picker (visual) -->
                    <label class="item-field item-field--wide">
                        <span>Ikon</span>

                        <!-- stores the selected filename -->
                        <input type="hidden" id="iconFileInput" value="" />

                        <!-- visual picker -->
                        <div id="iconGrid" class="icon-grid"></div>

                        <div class="hint" style="margin-top:0.35rem;">
                            Klicka på en ikon för att välja.
                        </div>

                        <div class="icon-preview-wrap">
                            <img id="iconPreview" alt="" class="icon-preview" style="display:none;" />
                        </div>
                    </label>

                    <label class="item-field item-field--wide">
                        <span>Beskrivning</span>
                        <textarea id="descriptionInput" rows="4" placeholder="Skriv item-text här..."></textarea>
                    </label>
                </div>

                <div class="item-actions">
                    <button type="button" id="itemCancelBtn" class="btn-small">Cancel</button>
                    <button type="button" id="itemDeleteBtn" class="btn-small" style="display:none;">Delete</button>
                    <button type="button" id="itemSaveBtn" class="btn-small">Save item</button>
                </div>
            </form>
        </dialog>
    </div>
</div>



@section Styles {
    <link rel="stylesheet" href="~/css/characterSheet.css" asp-append-version="true" />
}


@section Scripts {
    <script src="~/js/characterSheet.js" asp-append-version="true"></script>
}